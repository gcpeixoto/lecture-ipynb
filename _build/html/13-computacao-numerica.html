
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>13. Computação numérica &#8212; Introdução à Linguagem Python para Ciências Computacionais e Engenharia</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="14. Python Numérico (numpy): arrays" href="14-python-numerico-numpy.html" />
    <link rel="prev" title="12. Computação simbólica" href="12-computacao-simbolica.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/mayavi-samp.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Introdução à Linguagem Python para Ciências Computacionais e Engenharia</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="indice.html">
   Python para Ciências Computacionais e Engenharia
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Conteúdo
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01-introducao.html">
   1. Introdução
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-calculadora-poderosa.html">
   2. Uma calculadora poderosa
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-tipos-estruturas-dados.html">
   3. Tipos de Dados e Estruturas de Dados
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-introspeccao.html">
   4. Introspecção
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05-entrada-saida.html">
   5. Entrada e Saída de Dados
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06-fluxo-controle.html">
   6. Fluxo de Controle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07-funcoes-modulos.html">
   7. Funções e módulos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08-ferramentas-funcionais.html">
   8. Ferramentas funcionais
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09-tarefas-comuns.html">
   9. Tarefas comuns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10-matlab-para-python.html">
   10. Do Matlab para Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11-shells-python.html">
   11.
   <em>
    Shells
   </em>
   para Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12-computacao-simbolica.html">
   12. Computação simbólica
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   13. Computação numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14-python-numerico-numpy.html">
   14. Python Numérico (numpy):
   <em>
    arrays
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15-visualizando-dados.html">
   15. Visualização de dados
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16-metodos-numericos-scipy.html">
   16. Métodos numéricos usando Python (SciPy)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17-proximos-passos.html">
   17. Para onde ir a partir daqui?
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/13-computacao-numerica.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/gcpeixoto/lecture-ipynb/master?urlpath=lab/tree/13-computacao-numerica.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/gcpeixoto/lecture-ipynb/blob/master/13-computacao-numerica.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numeros-e-numeros">
   13.1. Números e números
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#limitacoes-dos-tipos-de-numeros">
     13.1.1. Limitações dos tipos de números
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#limitacoes-de-ints">
       13.1.1.1. Limitações de
       <code class="docutils literal notranslate">
        <span class="pre">
         int
        </span>
       </code>
       s
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#limitacoes-de-floats">
       13.1.1.2. Limitações de
       <code class="docutils literal notranslate">
        <span class="pre">
         float
        </span>
       </code>
       s
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#limitacoes-dos-numeros-complexos">
       13.1.1.3. Limitações dos números complexos
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sao-esses-tipos-de-numeros-de-valor-pratico">
       13.1.1.4. … são esses tipos de números de valor prático?
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#usando-numeros-de-ponto-flutuante-sem-o-devido-cuidado">
     13.1.2. Usando números de ponto flutuante (sem o devido cuidado)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#usando-numeros-de-ponto-flutuante-sem-o-devido-cuidado-1">
     13.1.3. Usando números de ponto flutuante sem o devido cuidado - 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#usando-numeros-de-ponto-flutuante-sem-o-devido-cuidado-2">
     13.1.4. Usando números de ponto flutuante sem o devido cuidado - 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculo-simbolico">
     13.1.5. Cálculo simbólico
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resumo">
     13.1.6. Resumo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercicio-laco-finito-ou-infinito">
     13.1.7. Exercício: laço finito ou infinito
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="computacao-numerica">
<h1><span class="section-number">13. </span>Computação numérica<a class="headerlink" href="#computacao-numerica" title="Permalink to this headline">¶</a></h1>
<div class="section" id="numeros-e-numeros">
<h2><span class="section-number">13.1. </span>Números e números<a class="headerlink" href="#numeros-e-numeros" title="Permalink to this headline">¶</a></h2>
<p>Já vimos que o Python reconhece diferentes <em>tipos</em> de números:</p>
<ul class="simple">
<li><p>números em ponto flutuante (<code class="docutils literal notranslate"><span class="pre">float</span></code>), como 3.14</p></li>
<li><p>inteiros (<code class="docutils literal notranslate"><span class="pre">int</span></code>) como 42</p></li>
<li><p>números complexos (<code class="docutils literal notranslate"><span class="pre">complex</span></code>), como 3.14 + 1*j</p></li>
</ul>
<div class="section" id="limitacoes-dos-tipos-de-numeros">
<h3><span class="section-number">13.1.1. </span>Limitações dos tipos de números<a class="headerlink" href="#limitacoes-dos-tipos-de-numeros" title="Permalink to this headline">¶</a></h3>
<div class="section" id="limitacoes-de-ints">
<h4><span class="section-number">13.1.1.1. </span>Limitações de <code class="docutils literal notranslate"><span class="pre">int</span></code>s<a class="headerlink" href="#limitacoes-de-ints" title="Permalink to this headline">¶</a></h4>
<p>A matemática fornece o conjunto infinito dos números naturais <span class="math notranslate nohighlight">\(\mathbb{ℕ} = \{1, 2, 3,\dots \}\)</span>. Como o computador opera de modo <em>finito</em>, é impossível que ele represente todos esses números. Em vez disso, apenas um pequeno subconjunto de números é representado.</p>
<p>O tipo <code class="docutils literal notranslate"><span class="pre">int</span></code> (geralmente [3]) representa números entre -2147483648 e +2147483647, e corresponde a 4 <em>bytes</em> (isto é 4*8 <em>bits</em> e 2<sup>32</sup> = 4294967296, que é o intervalo de -2147483648 a +2147483647).</p>
<p>Você pode imaginar que o hardware usa uma tabela como esta para codificar inteiros usando bits (suponha, por simplicidade, que usemos apenas 8 <em>bits</em>):</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>número natural</p></th>
<th class="text-align:right head"><p>representação binária</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>0</p></td>
<td class="text-align:right"><p>00000000</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>1</p></td>
<td class="text-align:right"><p>00000001</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>2</p></td>
<td class="text-align:right"><p>00000010</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>3</p></td>
<td class="text-align:right"><p>00000011</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>4</p></td>
<td class="text-align:right"><p>00000100</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>5</p></td>
<td class="text-align:right"><p>00000101</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>⋮</p></td>
<td class="text-align:right"><p>⋮</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>254</p></td>
<td class="text-align:right"><p>11111110</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>255</p></td>
<td class="text-align:right"><p>11111111</p></td>
</tr>
</tbody>
</table>
<p>Usando 8 <em>bits</em>, podemos representar 256 números naturais (por exemplo, de 0 a 255), pois temos 2<sup>8</sup> = 256 formas diferentes de combinar oito 0s e 1s.</p>
<p>Poderíamos também usar uma tabela ligeiramente diferente para descrever 256 números inteiros que variem, por exemplo, de -127 a +128.</p>
<p>Assim é, <em>em princípio</em>, como os números inteiros são representados no computador. Dependendo do número de <em>bytes</em> utilizados, apenas números inteiros entre um valor mínimo e um máximo podem ser representados. Nos hardwares de hoje, é comum usar 4 ou 8 <em>bytes</em> para representar um número inteiro, o que leva exatamente aos valores mínimo e máximo de -2147483648 e +2147483647, como mostrado acima para 4 <em>bytes</em>, e +9223372036854775807 como o inteiro máximo para 8 <em>bytes</em> (isto é ≈ 9.2⋅10<sup>18</sup>).</p>
</div>
<div class="section" id="limitacoes-de-floats">
<h4><span class="section-number">13.1.1.2. </span>Limitações de <code class="docutils literal notranslate"><span class="pre">float</span></code>s<a class="headerlink" href="#limitacoes-de-floats" title="Permalink to this headline">¶</a></h4>
<p>Os números em ponto flutuante em um computador não são os mesmos que os números em ponto flutuante da matemática. (Isto é exatamente o mesmo que dize que os números inteiros (matemáticos) não são os mesmos em um computador: apenas um <em>subconjunto</em> do conjunto infinito dos números inteiros pode ser representado pelo tipo <code class="docutils literal notranslate"><span class="pre">int</span></code>, como mostrado anteriormente). Então, como os números em ponto flutuante são representados no computador?</p>
<ul class="simple">
<li><p>Qualquer número real <span class="math notranslate nohighlight">\(x\)</span> pode ser escrito como
     $<span class="math notranslate nohighlight">\(x  = a \cdot 10^b,\)</span>$</p></li>
</ul>
<p>onde <span class="math notranslate nohighlight">\(a\)</span> é a mantissa e <span class="math notranslate nohighlight">\(b\)</span> o expoente.</p>
<ul class="simple">
<li><p>Exemplos:</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(x\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(a\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(b\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>123.45 = 1.23456 ⋅ 10<sup>2</sup></p></td>
<td><p>1.23456</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>1000000 = 1.0 ⋅ 10<sup>6</sup></p></td>
<td><p>1.00000</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-even"><td><p>0.0000024 = 2.4 ⋅ 10<sup>-6</sup></p></td>
<td><p>2.40000</p></td>
<td><p>-6</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Portanto, podemos usar 2 inteiros para codificar um número em ponto flutuante!</p></li>
</ul>
<ul class="simple">
<li><p>Seguindo (aproximadamente) o padrão IEEE-754, usa-se 8 <em>bytes</em> para um <code class="docutils literal notranslate"><span class="pre">float</span></code> <span class="math notranslate nohighlight">\(x\)</span>: estes 64 bits são divididos entre</p></li>
</ul>
<p>- 10 bits para o expoente <span class="math notranslate nohighlight">\(b\)</span> e</p>
<p>- 54 bits para a mantissa <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p>Isto resulta em</p>
<ul class="simple">
<li><p>maior número em ponto flutuante possível ≈ 10 <sup>308</sup> (medida de qualidade para <em>b</em>)</p></li>
<li><p>menor número em ponto flutuante possível (positivo) ≈ 10 <sup>-308</sup> (medida de qualidade para <span class="math notranslate nohighlight">\(b\)</span>)</p></li>
<li><p>distância entre 1.0 e o número imediatamente superior ≈ 10<sup>-16</sup> (medida de qualidade para <span class="math notranslate nohighlight">\(a\)</span>)</p></li>
</ul>
<p>Observe que, <em>a priori</em>, é assim como os números em ponto flutuante são armazenados (na realidade, é um pouco mais complicado).</p>
</div>
<div class="section" id="limitacoes-dos-numeros-complexos">
<h4><span class="section-number">13.1.1.3. </span>Limitações dos números complexos<a class="headerlink" href="#limitacoes-dos-numeros-complexos" title="Permalink to this headline">¶</a></h4>
<p>O tipo <code class="docutils literal notranslate"><span class="pre">complex</span></code> tem essencialmente as mesmas limitações que o tipo <code class="docutils literal notranslate"><span class="pre">float</span></code> porque um número complexo consiste de dois números <code class="docutils literal notranslate"><span class="pre">float</span></code>: um representa a parte real, o outro a parte imaginária.</p>
</div>
<div class="section" id="sao-esses-tipos-de-numeros-de-valor-pratico">
<h4><span class="section-number">13.1.1.4. </span>… são esses tipos de números de valor prático?<a class="headerlink" href="#sao-esses-tipos-de-numeros-de-valor-pratico" title="Permalink to this headline">¶</a></h4>
<p>Na prática cotidiana, geralmente não encontramos números que excedam 10<sup>300</sup> (este é um número com 300 zeros!). Portanto, os números em ponto flutuante cobrem o intervalo de números de que geralmente precisamos.</p>
<p>No entanto, você precisa estar ciente de que, em computação científica, números pequenos e grandes são usados, os quais podem (geralmente em resultados intermediários) exceder o intervalo de números em ponto flutuante.</p>
<ul class="simple">
<li><p>Imagine, por exemplo, que tenhamos de calcular a quarta potência da constante ℏ = 1.0545716 ⋅ 10 <sup>-34</sup> <em>kg. m<sup>2</sup>/s</em>:</p></li>
<li><p>ℏ <sup>4</sup> = 1.2368136958909421 ⋅ 10 <sup>-136</sup> <em>kg<sup>4</sup>.m<sup>8</sup>/s<sup>4</sup></em>, que está a “meio caminho” de nosso menor <code class="docutils literal notranslate"><span class="pre">float</span></code> positivo representável da ordem de 10<sup>-308</sup>.</p></li>
</ul>
<p>Se houver algum perigo de que possamos exceder os limites dos números em ponto flutuante, teremos que <em>escalonar</em> nossas equações de modo que (idealmente) todos os números sejam da ordem de 1. Escalonar nossas equações para que todos os números relevantes sejam próximos de 1 (normalização) também é útil para a depuração de código: se números muito maiores ou menores do que 1 surgirem, isso pode ser uma indicação de erro.</p>
</div>
</div>
<div class="section" id="usando-numeros-de-ponto-flutuante-sem-o-devido-cuidado">
<h3><span class="section-number">13.1.2. </span>Usando números de ponto flutuante (sem o devido cuidado)<a class="headerlink" href="#usando-numeros-de-ponto-flutuante-sem-o-devido-cuidado" title="Permalink to this headline">¶</a></h3>
<p>Já sabemos que precisamos ter cuidado para que nossos valores em ponto flutuante não excedam os limites que podem ser representados no computador (<em>underflow</em> e <em>overflow</em>). Há outra complicação devido à forma como os números em ponto flutuante têm de ser representados internamente: nem todos eles podem ser representados exatamente no computador. O número 1.0 pode ser representado exatamente, mas os números 0.1, 0.2 e 0.3 não:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;</span><span class="si">%.20f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;1.00000000000000000000&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;</span><span class="si">%.20f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0.10000000000000000555&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;</span><span class="si">%.20f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="mf">0.2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0.20000000000000001110&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;</span><span class="si">%.20f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="mf">0.3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0.29999999999999998890&#39;
</pre></div>
</div>
</div>
</div>
<p>Em vez disso, o número em ponto flutuante “mais próximo” do número real é escolhido.</p>
<p>Isso pode causar problemas. Suponha que precisemos de um laço onde <code class="docutils literal notranslate"><span class="pre">x</span></code> tome os valores 0,1, 0,2, 0,3, …, 0,9, 1,0. Podemos ser tentados a escrever algo como:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">x</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.1</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot; x = </span><span class="si">%19.17f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">x</span> <span class="p">))</span>
</pre></div>
</div>
<p>Entretanto, este laço nunca terminará. Aqui estão as primeiras 11 linhas de saída do programa:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>x=0.10000000000000001
x=0.20000000000000001
x=0.30000000000000004
x=0.40000000000000002
x=                0.5
x=0.59999999999999998
x=0.69999999999999996
x=0.79999999999999993
x=0.89999999999999991
x=0.99999999999999989
x=1.09999999999999987
</pre></div>
</div>
<p>Como a variável <code class="docutils literal notranslate"><span class="pre">x</span></code> nunca assume exatamente o valor 1.0, o laço <code class="docutils literal notranslate"><span class="pre">while</span></code> continuará infinitamente.</p>
<p>Portanto: <strong>Nunca compare dois números em ponto flutuante por igualdade!</strong></p>
</div>
<div class="section" id="usando-numeros-de-ponto-flutuante-sem-o-devido-cuidado-1">
<h3><span class="section-number">13.1.3. </span>Usando números de ponto flutuante sem o devido cuidado - 1<a class="headerlink" href="#usando-numeros-de-ponto-flutuante-sem-o-devido-cuidado-1" title="Permalink to this headline">¶</a></h3>
<p>Há várias alternativas para resolver este problema. Por exemplo, podemos comparar a distância entre dois números em ponto flutuante:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-8</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.1</span>
    <span class="nb">print</span> <span class="p">(</span> <span class="s2">&quot; x =</span><span class="si">%19.17f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">x</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> x =0.10000000000000001
 x =0.20000000000000001
 x =0.30000000000000004
 x =0.40000000000000002
 x =0.50000000000000000
 x =0.59999999999999998
 x =0.69999999999999996
 x =0.79999999999999993
 x =0.89999999999999991
 x =0.99999999999999989
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="usando-numeros-de-ponto-flutuante-sem-o-devido-cuidado-2">
<h3><span class="section-number">13.1.4. </span>Usando números de ponto flutuante sem o devido cuidado - 2<a class="headerlink" href="#usando-numeros-de-ponto-flutuante-sem-o-devido-cuidado-2" title="Permalink to this headline">¶</a></h3>
<p>Alternativamente, podemos iterar sobre uma sequência de inteiros e calcular o número em ponto flutuante a partir do inteiro:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mf">0.1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; x =</span><span class="si">%19.17f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">x</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> x =0.10000000000000001
 x =0.20000000000000001
 x =0.30000000000000004
 x =0.40000000000000002
 x =0.50000000000000000
 x =0.60000000000000009
 x =0.70000000000000007
 x =0.80000000000000004
 x =0.90000000000000002
 x =1.00000000000000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="mf">0.10000000000000001</span>
<span class="n">x</span><span class="o">=</span><span class="mf">0.20000000000000001</span>
<span class="n">x</span><span class="o">=</span><span class="mf">0.30000000000000004</span>
<span class="n">x</span><span class="o">=</span><span class="mf">0.40000000000000002</span>
<span class="n">x</span><span class="o">=</span>                <span class="mf">0.5</span>
<span class="n">x</span><span class="o">=</span><span class="mf">0.60000000000000009</span>
<span class="n">x</span><span class="o">=</span><span class="mf">0.70000000000000007</span>
<span class="n">x</span><span class="o">=</span><span class="mf">0.80000000000000004</span>
<span class="n">x</span><span class="o">=</span><span class="mf">0.90000000000000002</span>
<span class="n">x</span><span class="o">=</span>                  <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Se compararmos esta saída com aquela do programa do caso 1, veremos que os números em ponto flutuante diferem. Isto significa que - em cálculo numérico - não é verdade que 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 + 0.1 = 1.0.</p>
</div>
<div class="section" id="calculo-simbolico">
<h3><span class="section-number">13.1.5. </span>Cálculo simbólico<a class="headerlink" href="#calculo-simbolico" title="Permalink to this headline">¶</a></h3>
<p>Usando o pacote SymPy, temos precisão arbitrária. Usando <code class="docutils literal notranslate"><span class="pre">sympy.Rational</span></code>, podemos definir a fração 1/10 exatamente com o cálculo simbólico. Adicionando a fração 10 vezes, seremos levados exatamente ao valor 1, conforme demonstrado por este script:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Rational</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">Rational</span> <span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">x</span> <span class="o">!=</span> <span class="mf">1.0</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Atual x=</span><span class="si">%4s</span><span class="s2"> = </span><span class="si">%3.1f</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span> <span class="p">,</span> <span class="n">x</span> <span class="o">.</span> <span class="n">evalf</span> <span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Atingido x=</span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Atual x=1/10 = 0.1 
 Atingido x=1/10 
Atual x= 1/5 = 0.2 
 Atingido x=1/5 
Atual x=3/10 = 0.3 
 Atingido x=3/10 
Atual x= 2/5 = 0.4 
 Atingido x=2/5 
Atual x= 1/2 = 0.5 
 Atingido x=1/2 
Atual x= 3/5 = 0.6 
 Atingido x=3/5 
Atual x=7/10 = 0.7 
 Atingido x=7/10 
Atual x= 4/5 = 0.8 
 Atingido x=4/5 
Atual x=9/10 = 0.9 
 Atingido x=9/10 
Atual x=   1 = 1.0 
 Atingido x=1 
</pre></div>
</div>
</div>
</div>
<p>No entanto, esse cálculo simbólico é muito mais lento, já que é feito através de software em vez de operações de ponto flutuante baseadas em CPU. O próximo programa aproxima os desempenhos relativos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Rational</span>
<span class="n">dx_simbolico</span> <span class="o">=</span> <span class="n">Rational</span> <span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="k">def</span> <span class="nf">loop_sympy</span> <span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx_simbolico</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">loop_float</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">medir_tempo</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">time</span>
    <span class="n">tempo_inicial</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">tempo_final</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; desvio eh </span><span class="si">%16.15g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">n</span> <span class="o">*</span> <span class="n">dx_simbolico</span> <span class="o">-</span> <span class="n">resultado</span> <span class="p">))</span>
    <span class="k">return</span> <span class="n">tempo_final</span> <span class="o">-</span> <span class="n">tempo_inicial</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;laço usando float dx:&quot;</span><span class="p">)</span>
<span class="n">tempo_float</span> <span class="o">=</span> <span class="n">medir_tempo</span><span class="p">(</span><span class="n">loop_float</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;laço float n=</span><span class="si">%d</span><span class="s2"> leva </span><span class="si">%6.5f</span><span class="s2"> segundos&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">tempo_float</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;laço usando sympy simbólico dx:&quot;</span><span class="p">)</span>
<span class="n">tempo_sympy</span> <span class="o">=</span> <span class="n">medir_tempo</span><span class="p">(</span><span class="n">loop_sympy</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;laço sympy n =</span><span class="si">% d</span><span class="s2"> leva </span><span class="si">%6.5f</span><span class="s2"> segundos&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span> <span class="p">,</span> <span class="n">tempo_sympy</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;laço simbólico é um fator </span><span class="si">%.1f</span><span class="s2"> mais lento.&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">tempo_sympy</span> <span class="o">/</span> <span class="n">tempo_float</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>laco usando float dx:
 desvio eh -1.88483681995422e-08
laco float n=100000 leva 0.00944 segundos
laco usando sympy simbolico dx:
 desvio eh                0
laco sympy n = 100000 leva 1.80431 segundos
laco simbolico eh um fator 191.1 mais lento.
</pre></div>
</div>
</div>
</div>
<p>Este é, naturalmente, um exemplo artificial: adicionamos o código simbólico para demonstrar que esses erros de arredondamento originam-se da representação aproximada de números em ponto flutuante no hardware (e, portanto, linguagens de programação). Podemos, em princípio, evitar essas complicações através de cálculo com expressões simbólicas, mas, na prática, isso é muito lento. [4]</p>
</div>
<div class="section" id="resumo">
<h3><span class="section-number">13.1.6. </span>Resumo<a class="headerlink" href="#resumo" title="Permalink to this headline">¶</a></h3>
<p>Em resumo, aprendemos que</p>
<ul class="simple">
<li><p>números em ponto flutuante e inteiros utilizados em computação numérica geralmente são bastante diferentes dos “números matemáticos” (os cálculos simbólicos são exatos e usam os “números matemáticos”):</p></li>
</ul>
<p>- há um número máximo e um número mínimo que podem  ser representados (tanto para números inteiros como para ponto flutuante)</p>
<p>- dentro desse intervalo, nem todo número em ponto flutuante pode ser representado no computador.</p>
<ul class="simple">
<li><p>lidamos com essa limitação:</p></li>
</ul>
<p>- nunca comparando dois números em ponto flutuante por igualdade (em vez disso, calculamos o valor absoluto da diferença)</p>
<p>- uso de algoritmos que são <em>estáveis</em> (isto significa que pequenos desvios de números corretos podem ser corrigidos pelo algoritmo. Ainda não mostramos nenhum exemplo desse tipo neste documento.)</p>
<ul class="simple">
<li><p>Observe que há muito mais a dizer sobre métodos numéricos e técnicas algorítmicas para tornar a computação numérica tão precisa quanto possível, mas isto está fora do escopo desta seção.</p></li>
</ul>
</div>
<div class="section" id="exercicio-laco-finito-ou-infinito">
<h3><span class="section-number">13.1.7. </span>Exercício: laço finito ou infinito<a class="headerlink" href="#exercicio-laco-finito-ou-infinito" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>O que o seguinte fragmento de código computa? O laço terminará? Por quê?</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eps</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="k">while</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">eps</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="n">eps</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "gcpeixoto/lecture-ipynb",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="12-computacao-simbolica.html" title="previous page"><span class="section-number">12. </span>Computação simbólica</a>
    <a class='right-next' id="next-link" href="14-python-numerico-numpy.html" title="next page"><span class="section-number">14. </span>Python Numérico (numpy): <em>arrays</em></a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Gustavo Oliveira e Hans Fanghor<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>